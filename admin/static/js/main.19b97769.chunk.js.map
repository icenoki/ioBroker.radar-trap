{"version":3,"sources":["components/layout/MainContainer.jsx","App.jsx","components/layout/MainNavigation.jsx","components/layout/Layout.jsx","components/FormInput.jsx","components/FormAddress.jsx","components/FormCheckbox.jsx","components/FormCheckboxGroup.jsx","components/FormRadioGroup.jsx","components/AddressForm.jsx","components/CircularProgressWithLabel.jsx","components/RoutesTable.jsx","pages/Settings1Page.jsx","components/TrapInfo.jsx","components/SelectRoute.jsx","hooks/use-trap-box.js","hooks/use-mercator-viewport.js","helper/mapStyles.js","components/TrapMap.jsx","pages/Settings2Page.jsx","components/ibr/IbrInput.jsx","pages/Settings3Page.jsx","index.jsx"],"names":["withStyles","_theme","root","padding","spacing","children","classes","props","Container","className","Paper","square","style","height","elevation","Grid","container","direction","item","xs","socketio","require","io","NativeContext","createContext","App","GenericApp","constructor","super","encryptedFields","translations","this","state","renewTimer","isInTransition","onConnectionReady","console","log","socket","connect","document","domain","savedNative","client","configure","timeout","subscribeState","id","unsubscribeState","routeId","split","setState","Object","fromEntries","entries","filter","key","val","componentDidMount","feathers","componentWillUnmount","render","loaded","context","that","native","updateNativeValue","bind","Provider","value","routes","useContext","path","history","AppBar","position","Tabs","location","pathname","indicatorColor","textColor","variant","Tab","disabled","label","I18n","t","component","Link","to","instance","common","onError","text","errorText","onLoad","onLoadConfig","renderError","renderToast","renderSaveCloseButtons","textField","marginLeft","marginRight","width","name","defaultValue","control","useFormContext","field","ref","onChange","inputProps","fieldState","error","useController","TextField","size","target","inputRef","fullWidth","helperText","message","postfix","address","alignItems","Typography","titel","land","plz","ort","strasse","nummer","unregister","useEffect","Checkbox","checked","title","profile","checks","FormControl","margin","FormLabel","FormGroup","map","check","idx","FormControlLabel","radios","RadioGroup","keys","radio","Tooltip","placement","Radio","color","styles","textAlign","closeButton","right","top","palette","grey","DialogTitle","onClose","status","other","disableTypography","IconButton","onClick","DialogContent","theme","MuiDialogContent","DialogActions","MuiDialogActions","schema","yup","obj","shape","it","prototype","toString","call","reduce","a","matches","required","duration","min","max","open","setOpen","methods","useForm","mode","resolver","yupResolver","handleSubmit","watch","formState","isValid","patch","patchRoute","patchRouteStatus","useMutation","routeStatus","data","route","useGet","query","$select","closeHandler","Dialog","disableEscapeKeyDown","maxWidth","onSubmit","async","start","trim","geometry","ziel","settings","exclusion","undefined","err","marginBlockEnd","dividers","justifyContent","Divider","LinearProgress","Button","type","boxShadow","cursor","textDecoration","backgroundColor","progress","setProgress","useState","Math","round","Fab","renewing","CircularProgress","thickness","Box","sx","left","bottom","display","secs","floor","slice","lat","lng","Map","toll","ferry","motorway","fixedTraps","mobileTraps","roadWorks","trafficJams","sleekness","accidents","fog","objects","setRouteId","create","createRoute","remove","removeRoute","statusRoutes","useFind","realtime","statusTraps","update","updateTraps","length","md","TableContainer","Table","TableHead","TableRow","TableCell","align","TableBody","addressHandler","_id","Create","traps","directionId","paramsForServer","from","renewHandler","Delete","marginTop","cardHeaderStyles","makeStyles","primary","main","fontSize","cardContentStyles","marginBottom","TrapInfo","info","cardHeaderClasses","cardContentClasses","minWidth","Card","borderBottom","CardHeader","typeText","CardContent","street","vmax","reason","delay","createDate","confirmDate","cardControl","opacity","selectBg","background","routesStatus","InputLabel","Select","borderStyle","selectedRoute","e","setSelectedRoute","MenuItem","resetViewport","ZoomOutMap","useTrapBox","directionStatus","trapBox","setTrapBox","box","bbox","directionLine","useMercatorViewport","viewport","setViewport","window","innerHeight","longitude","latitude","zoom","useCallback","ov","transitionDuration","transitionInterpolator","FlyToInterpolator","transitionEasing","easeCubic","WebMercatorViewport","getElementById","clientWidth","clientHeight","fitBounds","offset","mapStyles","layout","paint","clusterTraps","clusterTrapsCount","lineTraps","trapsData","setTrapsData","hoverInfo","setHoverInfo","mapRef","useRef","trapsStatus","featureCollection","trap","values","list","Array","isArray","properties","polyline","resizeTimer","handleResize","clearTimeout","setTimeout","addEventListener","removeEventListener","forEach","image","current","getMap","hasImage","loadImage","process","mapimage","addImage","onHover","event","features","cluster","JSON","parse","lngLat","type_text","create_date","confirm_date","onInteractionStateChange","interactions","inTransition","mapboxApiAccessToken","mbxAccessToken","mapStyle","onViewportChange","interactiveLayerIds","cluster_id","feature","clusterId","sourceId","source","getSource","getClusterExpansionZoom","coordinates","attributionControl","anchor","clusterMaxZoom","clusterRadius","IbrInput","Component","attr","contextType","underlineAlways","textTransform","dark","grid","rel","underline","href","themeName","Utils","getThemeName","build","ReactDOM","adapterName","onThemeChange","exact","Settings1Page","Settings2Page","Settings3Page"],"mappings":"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","file":"static/js/main.19b97769.chunk.js","sourcesContent":["import React from \"react\";\r\nimport {Container, Paper, Grid} from \"@material-ui/core\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nconst styles = (_theme) => ({\r\n\troot: {\r\n\t\tpadding: _theme.spacing(0),\r\n\t},\r\n});\r\n\r\nconst MainContainer = ({children, classes, ...props}) => {\r\n\treturn (\r\n\t\t<Container\r\n\t\t\tclassName={classes.root}\r\n\t\t\t{...props}\r\n\t\t>\r\n\t\t\t<Paper square style={{height: \"100%\"}} elevation={0}>\r\n\t\t\t\t<Grid container direction=\"row\">\r\n\t\t\t\t\t<Grid item xs={12}>\r\n\t\t\t\t\t\t{children}\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</Grid>\r\n\t\t\t</Paper>\r\n\t\t</Container>\r\n\t);\r\n};\r\n\r\nexport default withStyles(styles)(MainContainer);\r\n","import React, {createContext} from \"react\";\r\nimport \"mapbox-gl/dist/mapbox-gl.css\";\r\nimport GenericApp from \"@iobroker/adapter-react/GenericApp\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nimport {Provider as FigbirdProvider} from \"figbird\";\r\nimport feathers from \"@feathersjs/feathers\";\r\n\r\nconst socketio = require(\"@feathersjs/socketio-client\");\r\nconst io = require(\"socket.io-client\");\r\n\r\nconst styles = (_theme) => ({});\r\n\r\nconst NativeContext = createContext({});\r\n\r\nclass App extends GenericApp {\r\n\tconstructor(props) {\r\n\t\tconst extendedProps = {\r\n\t\t\t...props,\r\n\t\t\tencryptedFields: [],\r\n\t\t\ttranslations: {\r\n\t\t\t\t\"en\": require(\"./i18n/en.json\"),\r\n\t\t\t\t\"de\": require(\"./i18n/de.json\"),\r\n\t\t\t\t\"ru\": require(\"./i18n/ru.json\"),\r\n\t\t\t\t\"pt\": require(\"./i18n/pt.json\"),\r\n\t\t\t\t\"nl\": require(\"./i18n/nl.json\"),\r\n\t\t\t\t\"fr\": require(\"./i18n/fr.json\"),\r\n\t\t\t\t\"it\": require(\"./i18n/it.json\"),\r\n\t\t\t\t\"es\": require(\"./i18n/es.json\"),\r\n\t\t\t\t\"pl\": require(\"./i18n/pl.json\"),\r\n\t\t\t\t\"zh-cn\": require(\"./i18n/zh-cn.json\"),\r\n\t\t\t},\r\n\t\t};\r\n\t\tsuper(props, extendedProps);\r\n\r\n\t\tthis.state = {...this.state, ...{renewTimer: {}}, ...{isInTransition: false}};\r\n\t}\r\n\r\n\tonConnectionReady() {\r\n\t\tconsole.log(\"Here we are...\");\r\n\t\tconst socket = io.connect(`https://${document.domain}:${this.savedNative[\"feathersPort\"]}`);\r\n\t\t// const socket = io.connect(`https://ibrtest.whew.synology.me:3030`);\r\n\t\tthis.client.configure(socketio(socket, {timeout: 120000}));\r\n\r\n\t\tthis.socket.subscribeState(\"*.timer\", false, (id, state) => {\r\n\t\t\tif (state === null) {\r\n\t\t\t\tthis.socket.unsubscribeState(id, null);\r\n\t\t\t\tconst routeId = id.split(\".\")[2];\r\n\t\t\t\tthis.setState({renewTimer: {...Object.fromEntries(Object.entries(this.state.renewTimer).filter(([key]) => key !== routeId))}});\r\n\t\t\t} else {\r\n\t\t\t\tconst routeId = id.split(\".\")[2];\r\n\t\t\t\tthis.setState({renewTimer: {...this.state.renewTimer, ...{[routeId]: state.val}}});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.client = feathers();\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.socket.unsubscribeState(\"*.timer\", () => {\r\n\t\t});\r\n\t}\r\n\r\n\trender() {\r\n\t\tif (!this.state.loaded) {\r\n\t\t\treturn super.render();\r\n\t\t}\r\n\r\n\t\tconst {children} = this.props;\r\n\r\n\t\tconst context = {\r\n\t\t\tthat: this,\r\n\t\t\tnative: this.state.native,\r\n\t\t\trenewTimer: this.state.renewTimer,\r\n\t\t\tisInTransition: this.state.isInTransition,\r\n\t\t\tupdateNativeValue: this.updateNativeValue.bind(this),\r\n\t\t};\r\n\r\n\t\treturn (\r\n\t\t\t<FigbirdProvider feathers={this.client}>\r\n\t\t\t\t<NativeContext.Provider value={context}>\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</NativeContext.Provider>\r\n\t\t\t</FigbirdProvider>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default withStyles(styles)(App);\r\nexport {NativeContext};\r\n","import React, {useContext} from \"react\";\r\nimport {Route, Link} from \"react-router-dom\";\r\nimport {Tabs, Tab, AppBar, Paper} from \"@material-ui/core\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\nimport I18n from \"@iobroker/adapter-react/i18n\";\r\nimport {NativeContext} from \"../../App\";\r\n\r\nconst styles = (_theme) => ({});\r\n\r\nconst routes = [\"/settings-1\", \"/settings-2\", \"/settings-3\"];\r\n\r\nfunction MainNavigation() {\r\n\tconst {isInTransition} = useContext(NativeContext);\r\n\r\n\treturn (\r\n\t\t<Route path=\"/\" render={(history) => (\r\n\t\t\t<AppBar position=\"relative\">\r\n\t\t\t\t<Paper\r\n\t\t\t\t\tsquare\r\n\t\t\t\t>\r\n\t\t\t\t\t<Tabs\r\n\t\t\t\t\t\tvalue={history.location.pathname !== \"/\" ? history.location.pathname : false}\r\n\t\t\t\t\t\tindicatorColor=\"primary\"\r\n\t\t\t\t\t\ttextColor=\"primary\"\r\n\t\t\t\t\t\tvariant=\"fullWidth\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Tab disabled={isInTransition} label={I18n.t(\"routes\")} value={routes[0]} component={Link} to={routes[0]}/>\r\n\t\t\t\t\t\t<Tab label={I18n.t(\"maps\")} value={routes[1]} component={Link} to={routes[1]}/>\r\n\t\t\t\t\t\t<Tab disabled={isInTransition} label={I18n.t(\"settings\")} value={routes[2]} component={Link} to={routes[2]}/>\r\n\t\t\t\t\t</Tabs>\r\n\t\t\t\t</Paper>\r\n\t\t\t</AppBar>\r\n\t\t)}/>\r\n\t);\r\n}\r\n\r\nexport default withStyles(styles)(MainNavigation);\r\n","import React, {useContext} from \"react\";\r\nimport {Grid} from \"@material-ui/core\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\nimport MainNavigation from \"./MainNavigation\";\r\nimport {NativeContext} from \"../../App\";\r\nimport Logo from \"@iobroker/adapter-react/Components/Logo\";\r\n\r\nconst styles = (_theme) => ({});\r\n\r\nfunction Layout(props) {\r\n\tconst {children} = props;\r\n\tconst {native, that} = useContext(NativeContext);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Grid\r\n\t\t\t\tspacing={1}\r\n\t\t\t\tcontainer\r\n\t\t\t\tdirection=\"column\"\r\n\t\t\t>\r\n\t\t\t\t<Grid item xs={12}>\r\n\t\t\t\t\t<header>\r\n\t\t\t\t\t\t<Logo\r\n\t\t\t\t\t\t\tinstance={that.instance}\r\n\t\t\t\t\t\t\tcommon={that.common}\r\n\t\t\t\t\t\t\tnative={native}\r\n\t\t\t\t\t\t\tonError={text => that.setState({errorText: text})}\r\n\t\t\t\t\t\t\tonLoad={that.onLoadConfig.bind(that)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<MainNavigation/>\r\n\t\t\t\t\t</header>\r\n\t\t\t\t</Grid>\r\n\r\n\t\t\t\t<Grid item xs={12}>\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</Grid>\r\n\t\t\t</Grid>\r\n\r\n\t\t\t<footer>\r\n\t\t\t\t{that.renderError.bind(that)()}\r\n\t\t\t\t{that.renderToast.bind(that)()}\r\n\t\t\t\t{that.renderSaveCloseButtons.bind(that)()}\r\n\t\t\t</footer>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default withStyles(styles)(Layout);\r\n","import React from \"react\";\r\nimport {useFormContext, useController} from \"react-hook-form\";\r\nimport {TextField} from \"@material-ui/core\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nconst styles = (_theme) => ({\r\n\ttextField: {\r\n\t\tmarginLeft: _theme.spacing(1),\r\n\t\tmarginRight: _theme.spacing(1),\r\n\t\twidth: \"30ch\",\r\n\t},\r\n});\r\n\r\nfunction FormInput(props) {\r\n\tconst {name, label, defaultValue, classes} = props;\r\n\tconst {control} = useFormContext();\r\n\tconst {field: {ref, onChange, ...inputProps}, fieldState: {error}} = useController({\r\n\t\tname,\r\n\t\tcontrol,\r\n\t\tdefaultValue: defaultValue ? defaultValue : \"\",\r\n\t});\r\n\r\n\treturn (\r\n\t\t<TextField\r\n\t\t\tsize=\"small\"\r\n\t\t\t{...inputProps}\r\n\t\t\tonChange={({target: {value}}) => onChange(value)}\r\n\t\t\tinputRef={ref}\r\n\t\t\tclassName={classes.textField}\r\n\t\t\tfullWidth\r\n\t\t\tlabel={label}\r\n\t\t\tvariant=\"filled\"\r\n\t\t\terror={!!error}\r\n\t\t\thelperText={error ? error.message : null}\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nexport default withStyles(styles)(FormInput);\r\n","import React from \"react\";\r\nimport I18n from \"@iobroker/adapter-react/i18n\";\r\nimport {Grid, Typography} from \"@material-ui/core\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\nimport FormInput from \"./FormInput\";\r\n\r\nconst styles = (_theme) => ({});\r\n\r\nfunction FormAddress(props) {\r\n\tconst {postfix, address} = props;\r\n\r\n\treturn (\r\n\t\t<Grid container item xs={12} direction=\"column\" alignItems=\"center\" spacing={1}>\r\n\t\t\t<Typography variant=\"h6\">\r\n\t\t\t\t{postfix === \"ziel\" ? \"Ziel\" : I18n.t(postfix)}\r\n\t\t\t</Typography>\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<FormInput\r\n\t\t\t\t\tlabel={I18n.t(\"description\")}\r\n\t\t\t\t\tname={`${postfix}.titel`}\r\n\t\t\t\t\tdefaultValue={address?.titel}\r\n\t\t\t\t/>\r\n\t\t\t</Grid>\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<FormInput\r\n\t\t\t\t\tlabel={I18n.t(\"country\")}\r\n\t\t\t\t\tname={`${postfix}.land`}\r\n\t\t\t\t\tdefaultValue={address?.land}\r\n\t\t\t\t/>\r\n\t\t\t</Grid>\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<FormInput\r\n\t\t\t\t\tlabel={I18n.t(\"postcode\")}\r\n\t\t\t\t\tname={`${postfix}.plz`}\r\n\t\t\t\t\tdefaultValue={address?.plz}\r\n\t\t\t\t/>\r\n\t\t\t</Grid>\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<FormInput\r\n\t\t\t\t\tlabel={I18n.t(\"location\")}\r\n\t\t\t\t\tname={`${postfix}.ort`}\r\n\t\t\t\t\tdefaultValue={address?.ort}\r\n\t\t\t\t/>\r\n\t\t\t</Grid>\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<FormInput\r\n\t\t\t\t\tlabel={I18n.t(\"street\")}\r\n\t\t\t\t\tname={`${postfix}.strasse`}\r\n\t\t\t\t\tdefaultValue={address?.strasse}\r\n\t\t\t\t/>\r\n\t\t\t</Grid>\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<FormInput\r\n\t\t\t\t\tlabel={I18n.t(\"house number\")}\r\n\t\t\t\t\tname={`${postfix}.nummer`}\r\n\t\t\t\t\tdefaultValue={address?.nummer}\r\n\t\t\t\t/>\r\n\t\t\t</Grid>\r\n\t\t</Grid>\r\n\t);\r\n}\r\n\r\nexport default withStyles(styles)(FormAddress);\r\n","import React, {useEffect}  from \"react\";\r\nimport {useFormContext, useController} from \"react-hook-form\";\r\nimport {Checkbox} from \"@material-ui/core\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nconst styles = (_theme) => ({});\r\n\r\nfunction FormCheckbox(props) {\r\n\tconst {name, defaultValue} = props;\r\n\tconst {control, unregister} = useFormContext();\r\n\r\n\tconst {field: {value, ref, onChange}} = useController({\r\n\t\tdefaultValue: defaultValue,\r\n\t\tcontrol: control,\r\n\t\tname: name,\r\n\t});\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => unregister(name);\r\n\t}, [unregister, name]);\r\n\r\n\treturn <Checkbox\r\n\t\tsize=\"small\"\r\n\t\tonChange={onChange}\r\n\t\tchecked={value}\r\n\t\tinputRef={ref}\r\n\t/>;\r\n}\r\n\r\nexport default withStyles(styles)(FormCheckbox);\r\n","import React from \"react\";\r\nimport I18n from \"@iobroker/adapter-react/i18n\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\nimport FormCheckbox from \"./FormCheckbox\";\r\nimport {Grid, FormLabel, FormControl, FormGroup, FormControlLabel} from \"@material-ui/core\";\r\n\r\nconst styles = (_theme) => ({});\r\n\r\nfunction FormCheckboxGroup(props) {\r\n\tconst {title, profile, checks} = props;\r\n\r\n\treturn (\r\n\t\t<Grid container item xs={12}>\r\n\t\t\t<FormControl margin=\"dense\" component=\"fieldset\">\r\n\t\t\t\t<FormLabel component=\"legend\">{title}</FormLabel>\r\n\t\t\t\t<FormGroup>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tObject.entries(checks).map((check, idx) => {\r\n\t\t\t\t\t\t\treturn <FormControlLabel\r\n\t\t\t\t\t\t\t\tkey={`${idx}-${profile}`}\r\n\t\t\t\t\t\t\t\tcontrol={<FormCheckbox\r\n\t\t\t\t\t\t\t\t\tdefaultValue={check[1]}\r\n\t\t\t\t\t\t\t\t\tname={`exclusion.${profile}.${check[0]}`}\r\n\t\t\t\t\t\t\t\t/>}\r\n\t\t\t\t\t\t\t\tlabel={I18n.t(check[0])}\r\n\t\t\t\t\t\t\t/>;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t</FormGroup>\r\n\t\t\t</FormControl>\r\n\t\t</Grid>\r\n\t);\r\n}\r\n\r\nexport default withStyles(styles)(FormCheckboxGroup);\r\n","import React from \"react\";\r\nimport I18n from \"@iobroker/adapter-react/i18n\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\nimport {Radio, RadioGroup, FormControl, FormLabel, FormControlLabel, Tooltip} from \"@material-ui/core\";\r\nimport {useController, useFormContext} from \"react-hook-form\";\r\n\r\nconst styles = (_theme) => ({});\r\n\r\nfunction FormRadioGroup(props) {\r\n\tconst {title, radios, defaultValue} = props;\r\n\tconst {control} = useFormContext();\r\n\tconst {field: {value, onChange}} = useController({\r\n\t\tname: \"profile\",\r\n\t\tcontrol,\r\n\t\tdefaultValue,\r\n\t});\r\n\r\n\treturn (\r\n\t\t<FormControl component=\"fieldset\" margin=\"dense\">\r\n\t\t\t<FormLabel component=\"legend\">{title}</FormLabel>\r\n\t\t\t<RadioGroup onChange={onChange} value={value}>\r\n\t\t\t\t{\r\n\t\t\t\t\tObject.keys(radios).map((radio, idx) =>\r\n\t\t\t\t\t\t<Tooltip key={idx} title={I18n.t(radio)} placement=\"top\">\r\n\t\t\t\t\t\t\t<FormControlLabel\r\n\t\t\t\t\t\t\t\tlabel={radio}\r\n\t\t\t\t\t\t\t\tcontrol={<Radio size=\"small\" color=\"primary\" value={radio}/>}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Tooltip>)\r\n\t\t\t\t}\r\n\t\t\t</RadioGroup>\r\n\t\t</FormControl>\r\n\t);\r\n}\r\n\r\nexport default withStyles(styles)(FormRadioGroup);\r\n","import React from \"react\";\r\nimport I18n from \"@iobroker/adapter-react/i18n\";\r\nimport {useForm, FormProvider} from \"react-hook-form\";\r\nimport {Typography, Button, Dialog, Grid} from \"@material-ui/core\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\nimport MuiDialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport MuiDialogContent from \"@material-ui/core/DialogContent\";\r\nimport MuiDialogActions from \"@material-ui/core/DialogActions\";\r\nimport {LinearProgress, Divider} from \"@material-ui/core\";\r\nimport * as yup from \"yup\";\r\nimport {yupResolver} from \"@hookform/resolvers/yup\";\r\nimport FormAddress from \"./FormAddress\";\r\nimport FormInput from \"./FormInput\";\r\nimport FormCheckboxGroup from \"./FormCheckboxGroup\";\r\nimport FormRadioGroup from \"./FormRadioGroup\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\nimport {useGet, useMutation} from \"figbird\";\r\n\r\nconst styles = (_theme) => ({\r\n\troot: {\r\n\t\ttextAlign: \"center\",\r\n\t\tmargin: 0,\r\n\t\tpadding: _theme.spacing(2),\r\n\t},\r\n\tcloseButton: {\r\n\t\tposition: \"absolute\",\r\n\t\tright: _theme.spacing(1),\r\n\t\ttop: _theme.spacing(2),\r\n\t\tcolor: _theme.palette.grey[500],\r\n\t},\r\n});\r\n\r\nconst DialogTitle = withStyles(styles)((props) => {\r\n\tconst {children, classes, onClose, status, ...other} = props;\r\n\treturn (\r\n\t\t<MuiDialogTitle\r\n\t\t\tdisableTypography\r\n\t\t\tclassName={classes.root} {...other}\r\n\t\t>\r\n\t\t\t<Typography variant=\"h4\">{children}</Typography>\r\n\t\t\t<IconButton\r\n\t\t\t\tdisabled={status === \"loading\"}\r\n\t\t\t\tclassName={classes.closeButton} onClick={onClose}>\r\n\t\t\t\t<CloseIcon/>\r\n\t\t\t</IconButton>\r\n\t\t</MuiDialogTitle>\r\n\t);\r\n});\r\n\r\nconst DialogContent = withStyles((theme) => ({\r\n\troot: {\r\n\t\tpadding: theme.spacing(2),\r\n\t},\r\n}))(MuiDialogContent);\r\n\r\nconst DialogActions = withStyles((theme) => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(2),\r\n\t},\r\n}))(MuiDialogActions);\r\n\r\nfunction isObject(it) {\r\n\treturn Object.prototype.toString.call(it) === \"[object Object]\";\r\n}\r\n\r\nconst schema = yup.lazy(obj => {\r\n\treturn yup.object().shape(\r\n\t\tObject.entries(obj).filter(([key, value]) => key !== \"exclusion\" && isObject(value)).reduce(\r\n\t\t\t(a, [key]) => {\r\n\t\t\t\treturn ({\r\n\t\t\t\t\t...a,\r\n\t\t\t\t\t[key]: yup.object().shape({\r\n\t\t\t\t\t\ttitel: yup.string()\r\n\t\t\t\t\t\t\t.matches(/^[\\s\\w\\-\\u00C0-\\u017F]+$/, \"Erlaubt sind a-z, A-Z, 0-9, _, - und Leerzeichen.\")\r\n\t\t\t\t\t\t\t.required(\"Bezeichnung ist ein Pflichtfeld\"),\r\n\t\t\t\t\t\tland: yup.string().matches(/^[\\s\\w\\-\\u00C0-\\u017F]+$/, \"Erlaubt sind a-z, A-Z, 0-9, _, - und Leerzeichen.\").required(\"Land ist ein Pflichtfeld\"),\r\n\t\t\t\t\t\tplz: yup.string().matches(/^([0][1-9]|[1-9][0-9])[0-9]{3}$/, \"Kein gültiges PLZ-Format.\").required(\"PLZ ist ein Pflichtfeld\"),\r\n\t\t\t\t\t\tort: yup.string().matches(/^[\\s\\w\\-\\u00C0-\\u017F]+$/, \"Erlaubt sind a-z, A-Z, 0-9, _, - und Leerzeichen.\").required(\"Ort ist ein Pflichtfeld\"),\r\n\t\t\t\t\t\tstrasse: yup.string()\r\n\t\t\t\t\t\t\t.matches(/^[\\s\\w\\-\\u00C0-\\u017F]+$/, \"Erlaubt sind a-z, A-Z, 0-9, _, - und Leerzeichen.\")\r\n\t\t\t\t\t\t\t.required(\"Strasse ist ein Pflichtfeld\"),\r\n\t\t\t\t\t}),\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tduration: yup.string()\r\n\t\t\t\t\t.min(0.5, \"Refreshzyklus muss mindestens 30 Sek. sein.\")\r\n\t\t\t\t\t.max(1440, \"Refreshzyklus muss kleiner als 24 Std. sein.\")\r\n\t\t\t\t\t.required(\"Refreshzyklus ist ein Pflichtfeld\"),\r\n\t\t\t}),\r\n\t);\r\n});\r\n\r\n/*const schema = yup.object().shape({\r\n\tstart: yup.object().shape({\r\n\t\tort: yup.string().required(\"Ort ist ein Pflichtfeld\"),\r\n\t}),\r\n\tziel: yup.object().shape({\r\n\t\tort: yup.string().required(\"Ort ist ein Pflichtfeld\"),\r\n\t}),\r\n});*/\r\n\r\nconst AddressForm = (props) => {\r\n\tconst {open, setOpen, routeId} = props;\r\n\r\n\tconst methods = useForm({mode: \"onChange\", resolver: yupResolver(schema)});\r\n\tconst {handleSubmit, watch, formState: {isValid}} = methods;\r\n\r\n\tconst {patch: patchRoute, status: patchRouteStatus} = useMutation(\"routes\");\r\n\tconst {status: routeStatus, data: route} = useGet(\"routes\", routeId, {query: {$select: [\"_id\", \"start\", \"ziel\", \"settings\"]}});\r\n\r\n\tconst profile = watch(\"profile\");\r\n\r\n\tconst closeHandler = (...data) => {\r\n\t\tif (data[1] !== \"backdropClick\") {\r\n\t\t\tsetOpen(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst submitHandler = async data => {\r\n\t\t// console.log(\"DATA IN SUBMITHANDLER: \", data);\r\n\r\n\t\ttry {\r\n\t\t\tawait patchRoute(routeId, {\r\n\t\t\t\t\"start\": {\r\n\t\t\t\t\t...Object.fromEntries(Object.entries(data.start).map(([key, value]) => [key, value.trim()])),\r\n\t\t\t\t\tgeometry: route.start.geometry,\r\n\t\t\t\t},\r\n\t\t\t\t\"ziel\": {\r\n\t\t\t\t\t...Object.fromEntries(Object.entries(data.ziel).map(([key, value]) => [key, value.trim()])),\r\n\t\t\t\t\tgeometry: route.ziel.geometry,\r\n\t\t\t\t},\r\n\t\t\t\t\"settings\": {\r\n\t\t\t\t\t\"exclusion\": {\r\n\t\t\t\t\t\t...route.settings.exclusion,\r\n\t\t\t\t\t\t[`${data.profile}`]: data.exclusion !== undefined ? data.exclusion[data.profile] : {},\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\"profile\": data.profile,\r\n\t\t\t\t\t\"duration\": data.duration.trim(),\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t} catch (err) {\r\n\t\t\t// console.log(\"patchRoute\", err);\r\n\t\t}\r\n\r\n\t\t(patchRouteStatus === \"success\" || patchRouteStatus === \"idle\") && setOpen(false);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\tdisableEscapeKeyDown={patchRouteStatus === \"loading\"}\r\n\t\t\tmaxWidth=\"md\"\r\n\t\t\topen={open}\r\n\t\t\tonClose={closeHandler}\r\n\t\t>\r\n\t\t\t<FormProvider {...methods}>\r\n\t\t\t\t<form onSubmit={handleSubmit(submitHandler)}\r\n\t\t\t\t\tstyle={{marginBlockEnd: 0}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<DialogTitle onClose={closeHandler} status={patchRouteStatus}>{I18n.t(\"edit route\")}</DialogTitle>\r\n\t\t\t\t\t<DialogContent dividers>\r\n\t\t\t\t\t\t<Grid container justifyContent=\"center\">\r\n\t\t\t\t\t\t\t<Grid item xs={6}>\r\n\t\t\t\t\t\t\t\t{routeStatus === \"success\" &&\r\n\t\t\t\t\t\t\t\t\t<FormAddress postfix=\"start\" address={route.start}/>}\r\n\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t\t<Grid item xs={6}>\r\n\t\t\t\t\t\t\t\t{routeStatus === \"success\" &&\r\n\t\t\t\t\t\t\t\t\t<FormAddress postfix=\"ziel\" address={route.ziel}/>}\r\n\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t<Divider style={{margin: \"10px 0\"}}/>\r\n\t\t\t\t\t\t<Grid container justifyContent=\"center\">\r\n\t\t\t\t\t\t\t{routeStatus === \"success\" && <FormInput\r\n\t\t\t\t\t\t\t\tlabel={I18n.t(\"refresh cycle in minutes\")}\r\n\t\t\t\t\t\t\t\tname=\"duration\"\r\n\t\t\t\t\t\t\t\tdefaultValue={route.settings.duration}\r\n\t\t\t\t\t\t\t/>}\r\n\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t<Divider style={{margin: \"10px 0\"}}/>\r\n\t\t\t\t\t\t<Grid container justifyContent=\"space-around\">\r\n\t\t\t\t\t\t\t<Grid item xs={4}>\r\n\t\t\t\t\t\t\t\t{routeStatus === \"success\" &&\r\n\t\t\t\t\t\t\t\t\t<FormRadioGroup title={I18n.t(\"profile\")} defaultValue={profile || route.settings.profile} radios={route.settings.exclusion}/>}\r\n\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t\t<Grid item xs={4}>\r\n\t\t\t\t\t\t\t\t{routeStatus === \"success\" && profile !== \"walking\" &&\r\n\t\t\t\t\t\t\t\t\t<FormCheckboxGroup title={I18n.t(\"exclusions\")} profile={profile || route.settings.profile} checks={route.settings.exclusion[profile || route.settings.profile]}/>}\r\n\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t</DialogContent>\r\n\t\t\t\t\t<DialogActions>\r\n\t\t\t\t\t\t{patchRouteStatus === \"loading\" &&\r\n\t\t\t\t\t\t\t<div style={{width: \"100%\"}}>\r\n\t\t\t\t\t\t\t\t<LinearProgress/>\r\n\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tdisabled={patchRouteStatus === \"loading\" || !isValid}\r\n\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t/*variant=\"contained\">Ok: {JSON.stringify(isValid)}</Button>*/\r\n\t\t\t\t\t\t\tvariant=\"contained\">Ok</Button>\r\n\t\t\t\t\t</DialogActions>\r\n\t\t\t\t</form>\r\n\t\t\t</FormProvider>\r\n\t\t</Dialog>\r\n\t);\r\n};\r\n\r\nexport default withStyles(styles)(AddressForm);\r\n","import React, {useEffect, useState} from \"react\";\r\nimport {Box, Fab, CircularProgress, Typography} from \"@material-ui/core\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nconst styles = (_theme) => ({\r\n\troot: {\r\n\t\tboxShadow: \"none\",\r\n\t\t\"&:hover\": {\r\n\t\t\tcursor: \"pointer\",\r\n\t\t\ttextDecoration: \"none\",\r\n\t\t\tbackgroundColor: \"#c5c5c5\",\r\n\t\t},\r\n\t},\r\n});\r\n\r\nconst toHHMMSS = (secs) => {\r\n\tconst hours = Math.floor(this / 3600) < 10 ? (\"00\" + Math.floor(secs / 3600)).slice(-2) : Math.floor(secs / 3600);\r\n\tconst minutes = (\"00\" + Math.floor((secs % 3600) / 60)).slice(-2);\r\n\tconst seconds = (\"00\" + (secs % 3600) % 60).slice(-2);\r\n\treturn hours + \":\" + minutes + \":\" + seconds;\r\n};\r\n\r\nfunction CircularProgressWithLabel({classes, ...props}) {\r\n\tconst [progress, setProgress] = useState(0);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetProgress(Math.round((1 - (props.value / (props.duration * 60))) * 100));\r\n\t}, [props.value, props.duration]);\r\n\r\n\treturn (\r\n\t\t<Fab\r\n\t\t\tclassName={classes.root}\r\n\t\t\tonClick={props.onClick}\r\n\t\t\tsize=\"large\"\r\n\t\t\tdisabled={props.renewing}\r\n\t\t>\r\n\t\t\t<CircularProgress\r\n\t\t\t\tsize={56}\r\n\t\t\t\tthickness={1.6} variant={props.renewing === true ? \"indeterminate\" : \"determinate\"} value={progress}\r\n\t\t\t/>\r\n\t\t\t<Box\r\n\t\t\t\tcomponent={Typography}\r\n\t\t\t\tvariant=\"caption\"\r\n\t\t\t\tsx={{\r\n\t\t\t\t\ttop: 2,\r\n\t\t\t\t\tleft: 0,\r\n\t\t\t\t\tbottom: 0,\r\n\t\t\t\t\tright: 0,\r\n\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\tdisplay: \"flex\",\r\n\t\t\t\t\talignItems: \"center\",\r\n\t\t\t\t\tjustifyContent: \"center\",\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{toHHMMSS(props.value)}\r\n\t\t\t</Box>\r\n\t\t</Fab>\r\n\t);\r\n}\r\n\r\nexport default withStyles(styles)(CircularProgressWithLabel);\r\n","import React, {useState, useContext} from \"react\";\r\nimport {Grid, Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Paper} from \"@material-ui/core\";\r\nimport {useFind, useMutation} from \"figbird\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nimport I18n from \"@iobroker/adapter-react/i18n\";\r\n\r\nimport AddressForm from \"./AddressForm\";\r\nimport {Button} from \"@material-ui/core\";\r\nimport {IconButton} from \"@material-ui/core\";\r\nimport {Create, Delete} from \"@material-ui/icons\";\r\nimport {paramsForServer} from \"feathers-hooks-common\";\r\n\r\nimport CircularProgressWithLabel from \"./CircularProgressWithLabel\";\r\n\r\nimport {NativeContext} from \"../App\";\r\n\r\nconst styles = (_theme) => ({});\r\n\r\nconst route = {\r\n\tstart: {titel: \"\", land: \"\", plz: \"\", ort: \"\", strasse: \"\", nummer: \"\", geometry: {lat: \"\", lng: \"\"}},\r\n\tziel: {titel: \"\", land: \"\", plz: \"\", ort: \"\", strasse: \"\", nummer: \"\", geometry: {lat: \"\", lng: \"\"}},\r\n\tsettings: {\r\n\t\texclusion: Object.fromEntries(new Map([\r\n\t\t\t[\"driving\", {toll: false, ferry: false, motorway: false}],\r\n\t\t\t[\"driving-traffic\", {toll: false, ferry: false, motorway: false}],\r\n\t\t\t[\"cycling\", {ferry: false}],\r\n\t\t\t[\"walking\", {}],\r\n\t\t])),\r\n\t\tprofile: \"driving\",\r\n\t\tfixedTraps: false,\r\n\t\tmobileTraps: false,\r\n\t\troadWorks: false,\r\n\t\ttrafficJams: false,\r\n\t\tsleekness: false,\r\n\t\taccidents: false,\r\n\t\tfog: false,\r\n\t\tobjects: false,\r\n\t\tduration: \"30\",\r\n\t},\r\n};\r\n\r\nfunction RoutesTable() {\r\n\tconst {renewTimer} = useContext(NativeContext);\r\n\tconst [open, setOpen] = useState(false);\r\n\tconst [routeId, setRouteId] = useState(null);\r\n\r\n\tconst {create: createRoute, remove: removeRoute} = useMutation(\"routes\");\r\n\tconst {status:statusRoutes, data: routes} = useFind(\"routes\", {realtime: \"refetch\"});\r\n\r\n\tconst {status: statusTraps, update: updateTraps} = useMutation(\"traps\");\r\n\r\n\tconst addressHandler = (id) => {\r\n\t\tsetRouteId(id);\r\n\t\tsetOpen(true);\r\n\t};\r\n\r\n\tconst renewHandler = (route) => {\r\n\t\t// console.log(\"route\", route);\r\n\t\t// console.log(\"PARAMSFROMSERVER\", paramsForServer({from: \"renew-handler\"}));\r\n\t\tsetRouteId(route._id);\r\n\t\troute.traps && updateTraps(route.traps._id, {routeId: route._id, directionId: route.direction._id, profile: route.settings.profile},\r\n\t\t\tparamsForServer({from: \"renew-handler\"}));\r\n\t};\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{\r\n\t\t\t\topen && <AddressForm\r\n\t\t\t\t\topen={open}\r\n\t\t\t\t\tsetOpen={setOpen}\r\n\t\t\t\t\trouteId={routeId}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t<Grid container direction=\"column\" alignItems=\"center\" spacing={2}>\r\n\t\t\t\t<Grid item>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tonClick={() => createRoute(route)}\r\n\t\t\t\t\t\tvariant=\"contained\"\r\n\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{I18n.t(\"add route\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t{\r\n\t\t\t\t\tstatusRoutes === \"success\" && routes.length !== 0 &&\r\n\t\t\t\t\t<Grid item container justifyContent=\"center\">\r\n\t\t\t\t\t\t<Grid item xs={12} md={6}>\r\n\t\t\t\t\t\t\t<TableContainer component={Paper} variant=\"elevation\" elevation={4}>\r\n\t\t\t\t\t\t\t\t<Table size=\"small\">\r\n\t\t\t\t\t\t\t\t\t<TableHead>\r\n\t\t\t\t\t\t\t\t\t\t<TableRow>\r\n\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"center\"><b>{I18n.t(\"edit\")}</b></TableCell>\r\n\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"center\"><b>{I18n.t(\"renew\")}</b></TableCell>\r\n\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"left\"><b>{I18n.t(\"start\")}</b></TableCell>\r\n\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"left\"><b>{I18n.t(\"target\")}</b></TableCell>\r\n\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"center\"><b>{I18n.t(\"delete\")}</b></TableCell>\r\n\t\t\t\t\t\t\t\t\t\t</TableRow>\r\n\t\t\t\t\t\t\t\t\t</TableHead>\r\n\r\n\t\t\t\t\t\t\t\t\t<TableBody>\r\n\t\t\t\t\t\t\t\t\t\t{statusRoutes === \"success\" && routes.map((route) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<TableRow key={route._id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={statusTraps === \"loading\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => addressHandler(route._id)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent=\"span\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Create/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{renewTimer[route._id] !== undefined && <CircularProgressWithLabel\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => renewHandler(route)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trenewing={(statusTraps === \"loading\" && routeId === route._id) || renewTimer[route._id] === 0}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// renewing={(statusTraps === \"loading\") || renewTimer[route._id] === 0}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={renewTimer[route._id]}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tduration={route.settings.duration}/>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<TableCell>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{route.start.titel || I18n.t(\"name for the starting point\")}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<TableCell>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{route.ziel.titel || I18n.t(\"name for the target point\")}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<TableCell align=\"center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={statusTraps === \"loading\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => removeRoute(route._id)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Delete/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\r\n\t\t\t\t\t\t\t\t\t\t\t</TableRow>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t</TableBody>\r\n\r\n\t\t\t\t\t\t\t\t</Table>\r\n\t\t\t\t\t\t\t</TableContainer>\r\n\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t}\r\n\t\t\t</Grid>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default withStyles(styles)(RoutesTable);\r\n","import React from \"react\";\r\nimport {Grid} from \"@material-ui/core\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nimport RoutesTable from \"../components/RoutesTable\";\r\n\r\nconst styles = (_theme) => ({\r\n\troot: {\r\n\t\tpadding: _theme.spacing(0),\r\n\t\tmarginTop: _theme.spacing(2),\r\n\t},\r\n});\r\n\r\nfunction Settings1Page({classes}) {\r\n\r\n\treturn (\r\n\t\t<Grid container direction=\"column\">\r\n\t\t\t<Grid className={classes.root} item xs={12}>\r\n\t\t\t\t<RoutesTable/>\r\n\t\t\t</Grid>\r\n\t\t</Grid>\r\n\t);\r\n}\r\n\r\nexport default withStyles(styles)(Settings1Page);\r\n","import * as React from \"react\";\r\nimport {Box, Card, CardHeader, CardContent, Typography} from \"@material-ui/core\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\n\r\nconst cardHeaderStyles = makeStyles(theme => ({\r\n\ttitle: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tmargin: 0,\r\n\t\tpadding: \"0 4px\",\r\n\t\t\"& .MuiTypography-h5\": {fontSize: \"1.2rem\"},\r\n\t\ttextAlign: \"center\",\r\n\t},\r\n}));\r\n\r\nconst cardContentStyles = makeStyles(theme => ({\r\n\troot: {\r\n\t\tmarginBottom: -24,\r\n\t\tpadding: \"0 8px\",\r\n\t},\r\n}));\r\n\r\nfunction TrapInfo({info}) {\r\n\tconst cardHeaderClasses = cardHeaderStyles();\r\n\tconst cardContentClasses = cardContentStyles();\r\n\r\n\treturn (\r\n\t\t<Box sx={{margin: \"-10px -10px -15px -10px\", padding: 0, minWidth: 200}}>\r\n\t\t\t<Card variant=\"elevation\" elevation={6}>\r\n\t\t\t\t<Box component=\"div\" sx={{borderBottom: \"2px solid black\"}}>\r\n\t\t\t\t\t<CardHeader className={cardHeaderClasses.title} title={info.typeText}/>\r\n\t\t\t\t</Box>\r\n\t\t\t\t<CardContent className={cardContentClasses.root}>\r\n\t\t\t\t\t{info.street && <Typography variant=\"subtitle2\"><b>Ort: </b>{info.street}</Typography>}\r\n\t\t\t\t\t{info.vmax && <Typography variant=\"subtitle2\"><b>Höchstgeschwindigkeit: </b>{info.vmax} km/h</Typography>}\r\n\t\t\t\t\t{info.reason && <Typography variant=\"subtitle2\"><b>Grund: </b>{info.reason}</Typography>}\r\n\t\t\t\t\t{info.length && <Typography variant=\"subtitle2\"><b>Staulänge: </b>{info.length} km</Typography>}\r\n\t\t\t\t\t{info.duration && info.duration !== 0 && <Typography variant=\"subtitle2\"><b>Dauer: </b>{info.duration} min.</Typography>}\r\n\t\t\t\t\t{info.delay && <Typography variant=\"subtitle2\"><b>Verzögerung: </b>{info.delay} min.</Typography>}\r\n\t\t\t\t\t{info.createDate && <Typography variant=\"subtitle2\"><b>gemeldet: </b>{info.createDate}</Typography>}\r\n\t\t\t\t\t{info.confirmDate && <Typography variant=\"subtitle2\"><b>bestätigt: </b>{info.confirmDate}</Typography>}\r\n\t\t\t\t</CardContent>\r\n\t\t\t</Card>\r\n\t\t</Box>\r\n\t);\r\n}\r\n\r\nexport default TrapInfo;\r\n","import React from \"react\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\nimport {Grid, Paper, Fab, FormControl, InputLabel, Select, MenuItem} from \"@material-ui/core\";\r\nimport {useFind} from \"figbird\";\r\nimport {ZoomOutMap} from \"@material-ui/icons\";\r\nimport I18n from \"@iobroker/adapter-react/i18n\";\r\n\r\nconst styles = (_theme) => ({\r\n\tcardControl: {\r\n\t\tpadding: _theme.spacing(1),\r\n\t\topacity: 0.75,\r\n\t},\r\n\tselectBg: {\r\n\t\tbackground: _theme.palette.primary.main,\r\n\t},\r\n});\r\n\r\nfunction SelectRoute(props) {\r\n\tconst {classes, settings} = props;\r\n\r\n\tconst {status: routesStatus, data: routes} = useFind(\"routes\");\r\n\r\n\tconst changeHandler = (e) => {\r\n\t\tsettings.setSelectedRoute(e.target.value);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Grid container justifyContent=\"space-between\" className={classes.cardControl}>\r\n\t\t\t<Grid item xs={3}>\r\n\t\t\t\t<FormControl\r\n\t\t\t\t\tcomponent={Paper}\r\n\t\t\t\t\televation={4}\r\n\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\tfullWidth\r\n\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<InputLabel>Route</InputLabel>\r\n\t\t\t\t\t<Select\r\n\t\t\t\t\t\tstyle={{borderStyle: \"hidden\"}}\r\n\t\t\t\t\t\tclassName={classes.selectBg}\r\n\t\t\t\t\t\tlabel={I18n.t(\"route\")}\r\n\t\t\t\t\t\tvalue={settings.selectedRoute}\r\n\t\t\t\t\t\tonChange={changeHandler}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<MenuItem value=\"none\"><em>None</em></MenuItem>\r\n\r\n\t\t\t\t\t\t{routesStatus === \"success\" && routes.map(route => {\r\n\t\t\t\t\t\t\treturn <MenuItem\r\n\t\t\t\t\t\t\t\tkey={route._id}\r\n\t\t\t\t\t\t\t\tvalue={route._id}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{route.start.titel} nach {route.ziel.titel}\r\n\t\t\t\t\t\t\t</MenuItem>;\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</Select>\r\n\t\t\t\t</FormControl>\r\n\t\t\t</Grid>\r\n\t\t\t<Grid item>\r\n\t\t\t\t<Fab style={{opacity: 0.9}} size=\"medium\" color=\"primary\" onClick={settings.resetViewport}>\r\n\t\t\t\t\t<ZoomOutMap/>\r\n\t\t\t\t</Fab>\r\n\t\t\t</Grid>\r\n\t\t</Grid>\r\n\t);\r\n}\r\n\r\nexport default withStyles(styles)(SelectRoute);\r\n","import {useEffect, useState} from \"react\";\r\nimport bbox from \"@turf/bbox\";\r\n\r\nconst useTrapBox = (directionStatus, direction) => {\r\n\tconst [trapBox, setTrapBox] = useState([]);\r\n\r\n\tuseEffect(() => {\r\n\t\t// console.log(\"useTrapBox->useEffect\");\r\n\r\n\t\tif (directionStatus !== \"success\" || direction.length === 0) {\r\n\t\t\tsetTrapBox([]);\r\n\t\t\t// console.log(\"directionLength\", direction);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// console.log(\"directionStatus\", directionStatus);\r\n\t\t// console.log(\"direction\", direction);\r\n\r\n\t\tconst box = bbox(direction[0].directionLine);\r\n\t\tsetTrapBox(box);\r\n\r\n\t\t// return () => console.log(\"useTrapBox unmounting\");\r\n\t}, [directionStatus, direction]);\r\n\r\n\treturn trapBox;\r\n};\r\n\r\nexport default useTrapBox;\r\n","import {useEffect, useCallback, useState} from \"react\";\r\nimport {WebMercatorViewport, FlyToInterpolator} from \"react-map-gl\";\r\nimport {easeCubic} from \"d3-ease\";\r\n\r\nconst useMercatorViewport = (box) => {\r\n\tconst [viewport, setViewport] = useState({\r\n\t\twidth: \"100%\",\r\n\t\theight: window.innerHeight - 208,\r\n\t\tlongitude: 10.129808,\r\n\t\tlatitude: 51.206213,\r\n\t\tzoom: 5,\r\n\t});\r\n\r\n\tconst resetViewport = useCallback(() => {\r\n\t\tif (box.length === 0) {\r\n\t\t\tsetViewport(ov => ({\r\n\t\t\t\t...ov,\r\n\t\t\t\twidth: \"100%\",\r\n\t\t\t\theight: window.innerHeight - 208,\r\n\t\t\t\tlongitude: 10.129808,\r\n\t\t\t\tlatitude: 51.206213,\r\n\t\t\t\tzoom: 5,\r\n\t\t\t\ttransitionDuration: \"auto\",\r\n\t\t\t\ttransitionInterpolator: new FlyToInterpolator(),\r\n\t\t\t\ttransitionEasing: easeCubic,\r\n\t\t\t}));\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst {longitude, latitude, zoom} = new WebMercatorViewport({\r\n\t\t\twidth: document.getElementById(\"trapMapContainer\").clientWidth,\r\n\t\t\theight: document.getElementById(\"trapMapContainer\").clientHeight,\r\n\t\t}).fitBounds(\r\n\t\t\t[[box[0], box[1]], [box[2], box[3]]], {\r\n\t\t\t\tpadding: 10,\r\n\t\t\t\toffset: [0, 0],\r\n\t\t\t});\r\n\r\n\t\tsetViewport(ov => ({\r\n\t\t\t...ov,\r\n\t\t\tlongitude,\r\n\t\t\tlatitude,\r\n\t\t\tzoom,\r\n\t\t\ttransitionDuration: \"auto\",\r\n\t\t\ttransitionInterpolator: new FlyToInterpolator(),\r\n\t\t\ttransitionEasing: easeCubic,\r\n\t\t}));\r\n\t}, [box]);\r\n\r\n\tuseEffect(() => {\r\n\t\tresetViewport();\r\n\t\t// return () => console.log(\"useMercatorViewport unmounting\");\r\n\t}, [resetViewport]);\r\n\r\n\treturn [viewport, setViewport, resetViewport];\r\n};\r\n\r\nexport default useMercatorViewport;\r\n","const mapStyles = {\r\n\troute: {\r\n\t\tid: \"route\",\r\n\t\ttype: \"line\",\r\n\t\tlayout: {\r\n\t\t\t\"line-join\": \"round\",\r\n\t\t\t\"line-cap\": \"round\",\r\n\t\t},\r\n\t\tpaint: {\r\n\t\t\t\"line-color\": \"#9C27B0\",\r\n\t\t\t\"line-width\": 5,\r\n\t\t\t\"line-opacity\": 0.8,\r\n\t\t},\r\n\t},\r\n\ttraps: {\r\n\t\tid: \"traps\",\r\n\t\ttype: \"symbol\",\r\n\t\t// filter: [\"match\", [\"get\", \"type_name\"], \"fixed-trap\", true, false],\r\n\t\tlayout: {\r\n\t\t\t\"icon-allow-overlap\": true,\r\n\t\t\t\"icon-image\": [\r\n\t\t\t\t\"match\", [\"get\", \"type_name\"],\r\n\t\t\t\t\"fixed-trap\", \"icon-fixed-trap\",\r\n\t\t\t\t\"mobile-trap\", \"icon-mobile-trap\",\r\n\t\t\t\t\"traffic-jam\", \"icon-traffic-jam\",\r\n\t\t\t\t\"road-work\", \"icon-road-work\",\r\n\t\t\t\t\"accident\", \"icon-accident\",\r\n\t\t\t\t\"object\", \"icon-object\",\r\n\t\t\t\t\"sleekness\", \"icon-sleekness\",\r\n\t\t\t\t\"fog\", \"icon-fog\",\r\n\t\t\t\t\"wrong-way-driver\", \"icon-wrong-way-driver\",\r\n\t\t\t\t\"\"],\r\n\t\t\t\"icon-size\": [\"interpolate\", [\"linear\"], [\"zoom\"], 1, 0.6, 14, 1.2],\r\n\t\t\t/*[\r\n\t\t\t\t\"match\", [\"get\", \"type_name\"],\r\n\t\t\t\t\"fixed-trap\", [\"interpolate\", [\"linear\"], [\"zoom\"], 3, 0.6, 12, 1.5],\r\n\t\t\t\t\"mobile-trap\", 0.4,\r\n\t\t\t\t\"traffic-jam\", 0.4,\r\n\t\t\t\t\"road-work\", 0.4,\r\n\t\t\t\t\"accident\", 0.4,\r\n\t\t\t\t\"object\", 0.4,\r\n\t\t\t\t\"sleekness\", 0.4,\r\n\t\t\t\t\"fog\", 0.4,\r\n\t\t\t\t0.4,\r\n\t\t\t\t// \"interpolate\", [\"linear\"], [\"zoom\"], 3, 0.4, 14, 0.9\r\n\t\t\t],*/\r\n\t\t},\r\n\t\tpaint: {\r\n\t\t\t\"icon-color\": \"#263238\",\r\n\t\t\t\"icon-opacity\": 0.7,\r\n\t\t},\r\n\t},\r\n\tclusterTraps: {\r\n\t\tid: \"cluster-traps\",\r\n\t\ttype: \"circle\",\r\n\t\tfilter: [\"has\", \"point_count\"],\r\n\t\tpaint: {\r\n\t\t\t\"circle-color\": [\"step\", [\"get\", \"point_count\"], \"#E1BEE7\", 100, \"#E1BEE7\", 750, \"#E1BEE7\"],\r\n\t\t\t\"circle-radius\": [\"step\", [\"get\", \"point_count\"], 15, 2, 15],\r\n\t\t},\r\n\t},\r\n\tclusterTrapsCount: {\r\n\t\tid: \"cluster-traps-count\",\r\n\t\ttype: \"symbol\",\r\n\t\tfilter: [\"has\", \"point_count\"],\r\n\t\tlayout: {\r\n\t\t\t\"text-allow-overlap\": true,\r\n\t\t\t\"text-field\": \"{point_count_abbreviated}\",\r\n\t\t\t\"text-font\": [\"DIN Offc Pro Medium\", \"Arial Unicode MS Bold\"],\r\n\t\t\t\"text-size\": 12,\r\n\t\t},\r\n\t},\r\n\tlineTraps: {\r\n\t\tid: \"line-traps\",\r\n\t\ttype: \"line\",\r\n\t\tfilter: [\"has\", \"linetrap\"],\r\n\t\tlayout: {\r\n\t\t\t\"line-join\": \"round\",\r\n\t\t\t\"line-cap\": \"round\",\r\n\t\t},\r\n\t\tpaint: {\r\n\t\t\t\"line-color\": \"#ff0000\",\r\n\t\t\t\"line-width\": 9,\r\n\t\t\t\"line-opacity\": 1,\r\n\t\t\t\"line-dasharray\": [1, 1.5],\r\n\t\t},\r\n\t},\r\n};\r\n\r\nexport default mapStyles;\r\n","import React, {useState, useContext, useEffect, useRef, useCallback} from \"react\";\r\nimport {Grid} from \"@material-ui/core\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\nimport TrapInfo from \"./TrapInfo\";\r\nimport SelectRoute from \"./SelectRoute\";\r\nimport useTrapBox from \"../hooks/use-trap-box\";\r\nimport useMercatorViewport from \"../hooks/use-mercator-viewport\";\r\nimport {feature, featureCollection} from \"@turf/helpers\";\r\nimport mapStyles from \"../helper/mapStyles\";\r\nimport MapGL, {Source, Layer, Popup, FlyToInterpolator} from \"react-map-gl\";\r\nimport {useFind} from \"figbird\";\r\nimport {easeCubic} from \"d3-ease\";\r\nimport {NativeContext} from \"../App\";\r\n\r\nconst styles = (_theme) => ({});\r\n\r\nfunction isArray(it) {\r\n\tif (typeof Array.isArray === \"function\") return Array.isArray(it);\r\n\treturn Object.prototype.toString.call(it) === \"[object Array]\";\r\n}\r\n\r\nfunction TrapMap() {\r\n\tconst {that} = useContext(NativeContext);\r\n\tconst [trapsData, setTrapsData] = useState(null);\r\n\tconst [hoverInfo, setHoverInfo] = useState(null);\r\n\tconst [selectedRoute, setSelectedRoute] = useState(\"none\");\r\n\r\n\tconst mapRef = useRef(null);\r\n\r\n\tconst {status: routeStatus, data: route} = useFind(\"routes\", {query: selectedRoute === \"none\" ? {_id: \"\"} : {_id: selectedRoute}});\r\n\t// console.log(\"routeStatus, route\", routeStatus, route);\r\n\r\n\tconst {status: directionStatus, data: direction} = useFind(\"directions\",\r\n\t\t{query: route && routeStatus === \"success\" && route.length !== 0 ? {routeId: route[0]._id} : {routeId: \"\"}});\r\n\t// console.log(\"directionStatus, direction\", directionStatus, direction);\r\n\r\n\tconst {status: trapsStatus, data: traps} = useFind(\"traps\",\r\n\t\t{query: route && routeStatus === \"success\" && route.length !== 0 ? {routeId: route[0]._id} : {routeId: \"\"}});\r\n\t// console.log(\"trapsStatus, traps\", trapsStatus, traps);\r\n\r\n\tconst trapBox = useTrapBox(directionStatus, direction);\r\n\tconst [viewport, setViewport, resetViewport] = useMercatorViewport(trapBox);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (trapsStatus === \"success\" && traps.length !== 0) {\r\n\t\t\t// console.log(\"TRAPS\", traps);\r\n\t\t\tsetTrapsData(featureCollection(...traps.map(trap =>\r\n\t\t\t\tObject.values(trap).reduce((list, t) => {\r\n\t\t\t\t\tif (isArray(t)) {\r\n\t\t\t\t\t\t// console.log(\"t is object\", t);\r\n\t\t\t\t\t\tconst lineTraps = t.filter(obj => obj.properties.polyline !== \"\").map(obj => obj.properties.polyline);\r\n\t\t\t\t\t\t// console.log(\"lineTraps\", lineTraps);\r\n\t\t\t\t\t\treturn [...list, ...t, ...lineTraps];\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn list;\r\n\t\t\t\t}, []))));\r\n\t\t} else {\r\n\t\t\tsetTrapsData(null);\r\n\t\t}\r\n\t}, [traps, trapsStatus]);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet resizeTimer;\r\n\r\n\t\tconst handleResize = () => {\r\n\t\t\tclearTimeout(resizeTimer);\r\n\t\t\tresizeTimer = setTimeout(function() {\r\n\t\t\t\tresetViewport();\r\n\t\t\t}, 250);\r\n\r\n\t\t\tsetViewport(ov => ({\r\n\t\t\t\t...ov,\r\n\t\t\t\twidth: \"100%\",\r\n\t\t\t\theight: window.innerHeight - 208,\r\n\t\t\t}));\r\n\t\t};\r\n\r\n\t\twindow.addEventListener(\"resize\", handleResize);\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener(\"resize\", handleResize);\r\n\t\t};\r\n\t}, [resetViewport, setViewport]);\r\n\r\n\tuseEffect(() => {\r\n\t\t[\r\n\t\t\t\"icon-fixed-trap\",\r\n\t\t\t\"icon-mobile-trap\",\r\n\t\t\t\"icon-traffic-jam\",\r\n\t\t\t\"icon-road-work\",\r\n\t\t\t\"icon-accident\",\r\n\t\t\t\"icon-object\",\r\n\t\t\t\"icon-sleekness\",\r\n\t\t\t\"icon-fog\",\r\n\t\t\t\"icon-wrong-way-driver\",\r\n\t\t].forEach(image => {\r\n\t\t\tif (!mapRef.current.getMap().hasImage(image)) {\r\n\t\t\t\tmapRef.current.getMap().loadImage((process.env.PUBLIC_URL + `/map-icons/${image}.png`), (error, mapimage) => {\r\n\t\t\t\t\tif (error) throw error;\r\n\r\n\t\t\t\t\tmapRef.current.getMap().addImage(image, mapimage, {\"sdf\": true});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}, [mapRef]);\r\n\r\n\tconst onHover = useCallback(event => {\r\n\t\tconst properties = event.features.length !== 0 && event.features[0].properties;\r\n\r\n\t\tif (!properties || properties.cluster) {\r\n\t\t\tsetHoverInfo(null);\r\n\t\t} else {\r\n\t\t\tconst info = properties.info !== \"false\" && JSON.parse(properties.info);\r\n\r\n\t\t\tsetHoverInfo({\r\n\t\t\t\tlongitude: event.lngLat[0],\r\n\t\t\t\tlatitude: event.lngLat[1],\r\n\t\t\t\ttypeText: properties.type_text,\r\n\t\t\t\tstreet: properties.street,\r\n\t\t\t\tvmax: properties.vmax && properties.vmax !==\"?\" && properties.vmax,\r\n\t\t\t\tcreateDate: properties.create_date !== \"0000-00-00 00:00:00\" && properties.create_date,\r\n\t\t\t\tconfirmDate: properties.confirm_date !== \"0000-00-00 00:00:00\" && properties.confirm_date,\r\n\t\t\t\treason: info && info.reason && info.reason,\r\n\t\t\t\tlength: info && info.length && info.length,\r\n\t\t\t\tduration: info && info.duration && Math.round(+info.duration / 60),\r\n\t\t\t\tdelay: info && info.delay && Math.round(+info.delay / 60),\r\n\t\t\t});\r\n\t\t}\r\n\t}, []);\r\n\r\n\tconst onClick = event => {\r\n\t\tif (!event.features.length || !event.features[0].properties.cluster_id) return;\r\n\r\n\t\tconst feature = event.features[0];\r\n\t\tconst clusterId = feature.properties.cluster_id;\r\n\t\tconst sourceId = feature.source;\r\n\r\n\t\tconst mapboxSource = mapRef.current.getMap().getSource(sourceId);\r\n\r\n\t\tmapboxSource.getClusterExpansionZoom(clusterId, (err, zoom) => {\r\n\t\t\tif (err) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tsetViewport({\r\n\t\t\t\t...viewport,\r\n\t\t\t\tlongitude: feature.geometry.coordinates[0],\r\n\t\t\t\tlatitude: feature.geometry.coordinates[1],\r\n\t\t\t\tzoom,\r\n\t\t\t\ttransitionDuration: \"auto\",\r\n\t\t\t\ttransitionInterpolator: new FlyToInterpolator(),\r\n\t\t\t\ttransitionEasing: easeCubic,\r\n\t\t\t\t//transitionDuration: 500,\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\tconst interactionStateChangeHandler = (interactions) => {\r\n\t\tthat.setState({...that.state, ...{isInTransition: interactions.inTransition}});\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Grid container justifyContent=\"center\" id=\"trapMapContainer\">\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<MapGL\r\n\t\t\t\t\t{...viewport}\r\n\t\t\t\t\tonInteractionStateChange={interactionStateChangeHandler}\r\n\t\t\t\t\tmapboxApiAccessToken={that.savedNative.mbxAccessToken}\r\n\t\t\t\t\tmapStyle=\"mapbox://styles/mapbox/streets-v11\"\r\n\t\t\t\t\tonViewportChange={setViewport}\r\n\t\t\t\t\tinteractiveLayerIds={(trapsData !== null && [\"cluster-traps\", \"traps\"]) || []}\r\n\t\t\t\t\tonClick={onClick}\r\n\t\t\t\t\tonHover={onHover}\r\n\t\t\t\t\tref={mapRef}\r\n\t\t\t\t\tattributionControl={false}\r\n\t\t\t\t>\r\n\t\t\t\t\t<SelectRoute\r\n\t\t\t\t\t\tsettings={{selectedRoute, setSelectedRoute, resetViewport}}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t{hoverInfo !== null && (\r\n\t\t\t\t\t\t<Popup\r\n\t\t\t\t\t\t\tanchor=\"top\"\r\n\t\t\t\t\t\t\tlongitude={hoverInfo.longitude}\r\n\t\t\t\t\t\t\tlatitude={hoverInfo.latitude}\r\n\t\t\t\t\t\t\tcloseButton={false}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<TrapInfo info={hoverInfo}/>\r\n\t\t\t\t\t\t</Popup>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{directionStatus === \"success\" && direction.length !== 0 &&\r\n\t\t\t\t\t\t<Source type=\"geojson\" data={feature(direction[0].directionLine)}>\r\n\t\t\t\t\t\t\t<Layer {...mapStyles.route} />\r\n\t\t\t\t\t\t</Source>}\r\n\r\n\t\t\t\t\t{trapsData !== null &&\r\n\t\t\t\t\t\t<Source\r\n\t\t\t\t\t\t\ttype=\"geojson\"\r\n\t\t\t\t\t\t\tdata={trapsData}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Layer {...mapStyles.lineTraps} />\r\n\t\t\t\t\t\t</Source>}\r\n\r\n\t\t\t\t\t{trapsData !== null &&\r\n\t\t\t\t\t\t<Source\r\n\t\t\t\t\t\t\ttype=\"geojson\"\r\n\t\t\t\t\t\t\tdata={trapsData}\r\n\t\t\t\t\t\t\tcluster={true}\r\n\t\t\t\t\t\t\tclusterMaxZoom={14}\r\n\t\t\t\t\t\t\tclusterRadius={50}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Layer {...mapStyles.traps} />\r\n\t\t\t\t\t\t\t<Layer {...mapStyles.clusterTraps} />\r\n\t\t\t\t\t\t\t<Layer {...mapStyles.clusterTrapsCount} />\r\n\t\t\t\t\t\t</Source>}\r\n\t\t\t\t</MapGL>\r\n\t\t\t</Grid>\r\n\t\t</Grid>\r\n\t);\r\n}\r\n\r\nexport default withStyles(styles)(TrapMap);\r\n","import React from \"react\";\r\nimport {Grid} from \"@material-ui/core\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\nimport TrapMap from \"../components/TrapMap\";\r\n\r\nconst styles = (_theme) => ({});\r\n\r\nfunction Settings2Page() {\r\n\treturn (\r\n\t\t<Grid container justifyContent=\"center\">\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<TrapMap/>\r\n\t\t\t</Grid>\r\n\t\t</Grid>\r\n\t);\r\n}\r\n\r\nexport default withStyles(styles)(Settings2Page);\r\n","import React, {Component} from \"react\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\nimport I18n from \"@iobroker/adapter-react/i18n\";\r\n\r\nimport {NativeContext} from \"../../App\";\r\n\r\nconst styles = (_theme) => ({\r\n\ttextField: {\r\n\t\tmarginLeft: _theme.spacing(0),\r\n\t\tmarginRight: _theme.spacing(0),\r\n\t},\r\n});\r\n\r\nclass IbrInput extends Component {\r\n\tstatic contextType = NativeContext;\r\n\r\n\trender() {\r\n\t\tconst {classes} = this.props;\r\n\t\tconst {native, updateNativeValue} = this.context;\r\n\t\tconst {attr, type, title} = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<TextField\r\n\t\t\t\tclassName={classes.textField}\r\n\t\t\t\tlabel={I18n.t(title)}\r\n\t\t\t\tfullWidth\r\n\t\t\t\tvariant=\"filled\"\r\n\t\t\t\tvalue={native[attr]}\r\n\t\t\t\ttype={type || \"text\"}\r\n\t\t\t\tonChange={(e) => updateNativeValue(attr, e.target.value)}\r\n\t\t\t\tmargin=\"dense\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default withStyles(styles)(IbrInput);\r\n","import React from \"react\";\r\nimport {Grid, Paper, Link} from \"@material-ui/core\";\r\nimport IbrInput from \"../components/ibr/IbrInput\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nconst styles = (_theme) => ({\r\n\tunderlineAlways: {\r\n\t\tcolor: _theme.palette.primary.main,\r\n\t\ttextTransform: \"none\",\r\n\t\t\"&:hover\" : {\r\n\t\t\tcolor: _theme.palette.primary.dark,\r\n\t\t}\r\n\t},\r\n\tgrid: {\r\n\t\tpadding: _theme.spacing(1),\r\n\t\tmarginTop: _theme.spacing(2),\r\n\t},\r\n});\r\n\r\nfunction Settings3Page({classes}) {\r\n\treturn (\r\n\t\t<Grid container justifyContent=\"center\">\r\n\t\t\t<Grid className={classes.grid} component={Paper} variant=\"elevation\" elevation={4} item xs={11}>\r\n\t\t\t\t<Grid item xs={2}>\r\n\t\t\t\t\t<IbrInput title=\"Feathers Port\" attr=\"feathersPort\" type=\"text\"/>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid item xs={12}>\r\n\t\t\t\t\t<IbrInput title=\"Mapbox Token\" attr=\"mbxAccessToken\" type=\"text\"/>\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tclasses={{underlineAlways: classes.underlineAlways}}\r\n\t\t\t\t\t\tvariant=\"body2\"\r\n\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\trel=\"noopener\"\r\n\t\t\t\t\t\tunderline=\"always\"\r\n\t\t\t\t\t\thref=\"https://mapbox.com\"\r\n\t\t\t\t\t>Mapbox Token bekommen</Link>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid item xs={12}>\r\n\t\t\t\t\t<IbrInput title=\"OpenCage ID\" attr=\"opencageId\" type=\"text\"/>\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tclasses={{underlineAlways: classes.underlineAlways}}\r\n\t\t\t\t\t\tvariant=\"body2\"\r\n\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\trel=\"noopener\"\r\n\t\t\t\t\t\tunderline=\"always\"\r\n\t\t\t\t\t\thref=\"https://opencagedata.com\"\r\n\t\t\t\t\t>OpenCage ID bekommen</Link>\r\n\t\t\t\t</Grid>\r\n\t\t\t</Grid>\r\n\t\t</Grid>);\r\n}\r\n\r\nexport default withStyles(styles)(Settings3Page);\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport {BrowserRouter, Route, Switch, Redirect} from \"react-router-dom\";\r\nimport {MuiThemeProvider} from \"@material-ui/core/styles\";\r\nimport MainContainer from \"./components/layout/MainContainer\";\r\nimport theme from \"@iobroker/adapter-react/Theme\";\r\nimport Utils from \"@iobroker/adapter-react/Components/Utils\";\r\nimport App from \"./App\";\r\n\r\nimport Layout from \"./components/layout/Layout\";\r\nimport Settings1Page from \"./pages/Settings1Page\";\r\nimport Settings2Page from \"./pages/Settings2Page\";\r\nimport Settings3Page from \"./pages/Settings3Page\";\r\n\r\nlet themeName = Utils.getThemeName();\r\n\r\nfunction build() {\r\n\tReactDOM.render(\r\n\t\t<MuiThemeProvider theme={theme(themeName)}>\r\n\t\t\t<MainContainer maxWidth=\"xl\">\r\n\t\t\t\t<App\r\n\t\t\t\t\tadapterName=\"radar-trap\"\r\n\t\t\t\t\tonThemeChange={(_theme) => {\r\n\t\t\t\t\t\tthemeName = _theme;\r\n\t\t\t\t\t\tbuild();\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<BrowserRouter>\r\n\t\t\t\t\t\t<Redirect from=\"/\" to=\"/settings-1\" exact/>\r\n\t\t\t\t\t\t<Layout>\r\n\t\t\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t\t\t<Route path=\"/settings-1\" exact component={Settings1Page}/>\r\n\t\t\t\t\t\t\t\t<Route path=\"/settings-2\" exact component={Settings2Page}/>\r\n\t\t\t\t\t\t\t\t<Route path=\"/settings-3\" exact component={Settings3Page}/>\r\n\t\t\t\t\t\t\t</Switch>\r\n\t\t\t\t\t\t</Layout>\r\n\t\t\t\t\t</BrowserRouter>\r\n\t\t\t\t</App>\r\n\t\t\t</MainContainer>\r\n\t\t</MuiThemeProvider>,\r\n\t\tdocument.getElementById(\"root\"),\r\n\t);\r\n}\r\n\r\nbuild();\r\n"],"sourceRoot":""}